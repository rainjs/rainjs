

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Client Runtime: Messaging API (Proposal A) &mdash; Rain v0.29.0 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.29.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Rain v0.29.0 documentation" href="../index.html" />
    <link rel="next" title="Client Runtime (Proposal A)" href="Features-proposal-client-runtime-a.html" />
    <link rel="prev" title="Client Language Inline Editing" href="Features-proposal-client-language-inline-editing.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="Features-proposal-client-runtime-a.html" title="Client Runtime (Proposal A)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Features-proposal-client-language-inline-editing.html" title="Client Language Inline Editing"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Rain v0.29.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="client-runtime-messaging-api-proposal-a">
<h1>Client Runtime: Messaging API (Proposal A)<a class="headerlink" href="#client-runtime-messaging-api-proposal-a" title="Permalink to this headline">¶</a></h1>
<p>This layer can be accessed in the client side controllers and allows interaction with all messaging mechanism provided by RAIN.</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<img alt="../_images/messaging_overview.png" src="../_images/messaging_overview.png" />
</div>
<div class="section" id="functional-requirements">
<h2>Functional requirements<a class="headerlink" href="#functional-requirements" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ol class="arabic simple">
<li>Messaging layer must provide communication between fragments on client side.</li>
<li>Messaging layer must provide communication between fragments on server side.</li>
<li>Messaging layer must provide pluggable error handling mechanism for server side messaging.</li>
<li>Messaging layer must provide a default behavior in case of server side messaging error.</li>
<li>Messaging layer default error handling behavior must be internationalized.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="messaging-api">
<h2>Messaging api<a class="headerlink" href="#messaging-api" title="Permalink to this headline">¶</a></h2>
<img alt="../_images/messaging_api.png" src="../_images/messaging_api.png" />
</div>
<div class="section" id="client-side-messaging">
<h2>Client side messaging<a class="headerlink" href="#client-side-messaging" title="Permalink to this headline">¶</a></h2>
<p>Client side messaging is already available in RAIN. It&#8217;s a simple publish subscriber mechanism. No error handling is required at this level.</p>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>TBD</p>
</div>
</div>
<div class="section" id="server-side-messaging">
<h2>Server side messaging<a class="headerlink" href="#server-side-messaging" title="Permalink to this headline">¶</a></h2>
<p>Server side messaging it&#8217;s similar to intents from Android operating system.</p>
<div class="section" id="intent-lifecycle">
<h3>Intent lifecycle<a class="headerlink" href="#intent-lifecycle" title="Permalink to this headline">¶</a></h3>
<p>Intents express &#8220;intention&#8221; to do something. For instance, an application developer might want to configure a mail server. This should be not his concern but probably an external application concern.</p>
<p>For implementing this mechanism we want to take into consideration authorization process (if a user is allowed to do the requested action) and error handling (as intents will involve asynchronous requests). Moreover intents need to be defined in the application descriptor and must be centralized by RAIN platform.</p>
</div>
<div class="section" id="id1">
<h3>Intent lifecycle<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<img alt="../_images/messaging_intent_request1.png" src="../_images/messaging_intent_request1.png" />
<p>It is really important to know that when expressing an intent developer will be able to send a json object that holds specific information. For instance, when sending an email you already know were you want to send it. The expected behavior is to receive back the send mail application with all fields completed.</p>
</div>
<div class="section" id="application-descriptor">
<h3>Application descriptor<a class="headerlink" href="#application-descriptor" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;id&quot;</span> <span class="o">:</span> <span class="s2">&quot;my-app;1.0&quot;</span>
  <span class="s2">&quot;url&quot;</span> <span class="o">:</span> <span class="s2">&quot;/modules/my-app&quot;</span><span class="p">,</span>
  <span class="s2">&quot;views&quot;</span> <span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span><span class="s2">&quot;viewId&quot;</span> <span class="o">:</span> <span class="s2">&quot;send-mail-view&quot;</span><span class="p">,</span>
       <span class="s2">&quot;view&quot;</span> <span class="o">:</span> <span class="s2">&quot;/htdocs/send-mail.html&quot;</span><span class="p">},</span>
      <span class="p">{</span><span class="s2">&quot;viewId&quot;</span> <span class="o">:</span> <span class="s2">&quot;send-mail-google-view&quot;</span><span class="p">,</span>
       <span class="s2">&quot;view&quot;</span> <span class="o">:</span> <span class="s2">&quot;/htdocs/send-mail-google.html&quot;</span><span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;intents&quot;</span> <span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span><span class="s2">&quot;intentId&quot;</span> <span class="o">:</span> <span class="s2">&quot;com.1and1.intents.general.microsoft.SEND_MAIL&quot;</span><span class="p">,</span>
       <span class="s2">&quot;action&quot;</span> <span class="o">:</span> <span class="s2">&quot;com.1and1.intents.general.SEND_MAIL&quot;</span><span class="p">,</span>
       <span class="s2">&quot;categoryId&quot;</span> <span class="o">:</span> <span class="s2">&quot;com.1and1.controlpanel.mail&quot;</span><span class="p">,</span>
       <span class="s2">&quot;viewId&quot;</span> <span class="o">:</span> <span class="s2">&quot;send-mail-view&quot;</span><span class="p">},</span>
      <span class="p">{</span><span class="s2">&quot;intentId&quot;</span> <span class="o">:</span> <span class="s2">&quot;com.1and1.intents.general.google.SEND_MAIL&quot;</span><span class="p">,</span>
       <span class="s2">&quot;action&quot;</span> <span class="o">:</span> <span class="s2">&quot;com.1and1.intents.general.SEND_MAIL&quot;</span><span class="p">,</span>
       <span class="s2">&quot;categoryId&quot;</span> <span class="o">:</span> <span class="s2">&quot;com.1and1.controlpanel.mail&quot;</span><span class="p">,</span>
       <span class="s2">&quot;viewId&quot;</span> <span class="o">:</span> <span class="s2">&quot;send-mail-view&quot;</span><span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="client-side-view-controller-source-view">
<h3>Client side view controller - source view<a class="headerlink" href="#client-side-view-controller-source-view" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span><span class="o">&gt;</span>
  <span class="nx">define</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">function</span> <span class="nx">init</span><span class="p">(</span><span class="nx">viewContext</span><span class="p">,</span> <span class="nx">clientRuntime</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">intent</span> <span class="o">=</span> <span class="p">{};</span>

      <span class="c1">// add attributes to the intent from the current fragment.</span>
      <span class="nx">clientRuntime</span><span class="p">.</span><span class="nx">messaging</span><span class="p">.</span><span class="nx">serverMessaging</span><span class="p">.</span><span class="nx">sendIntent</span><span class="p">(</span><span class="nx">viewContext</span><span class="p">,</span> <span class="s2">&quot;com.1and1.controlpanel.mail&quot;</span><span class="p">,</span> <span class="s2">&quot;com.1and1.intents.general.SEND_MAIL&quot;</span><span class="p">,</span> <span class="nx">intent</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">{</span><span class="nx">init</span> <span class="o">:</span> <span class="nx">init</span><span class="p">};</span>
  <span class="p">});</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="client-side-view-controller-destination-view">
<h3>Client side view controller - destination view<a class="headerlink" href="#client-side-view-controller-destination-view" title="Permalink to this headline">¶</a></h3>
<p>This is a proposal of how to change the init signature to also reflect the intent object. It is useful to know in the intent view if it was accessed using the intent mechanism or by direct url.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span><span class="o">&gt;</span>
  <span class="nx">define</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">function</span> <span class="nx">init</span><span class="p">(</span><span class="nx">viewContext</span><span class="p">,</span> <span class="nx">clientRuntime</span><span class="p">,</span> <span class="nx">intentContext</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// you can access intentContext as any other map.</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">{</span><span class="nx">init</span> <span class="o">:</span> <span class="nx">init</span><span class="p">};</span>
  <span class="p">});</span>
</pre></div>
</td></tr></table></div>
<p>IntentContext is nothing else than a map. Following the send mail example it might contain the following information:</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;to&quot;</span> <span class="o">:</span> <span class="s2">&quot;customer@email.com&quot;</span><span class="p">,</span>
 <span class="s2">&quot;cc&quot;</span> <span class="o">:</span> <span class="p">[</span><span class="s2">&quot;admin@email.com&quot;</span><span class="p">,</span> <span class="p">...],</span>
 <span class="s2">&quot;bcc&quot;</span> <span class="o">:</span> <span class="p">[</span><span class="s2">&quot;...&quot;</span><span class="p">,</span> <span class="p">...],</span>
 <span class="s2">&quot;subject&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
 <span class="s2">&quot;body&quot;</span> <span class="o">:</span> <span class="s2">&quot;.........................&quot;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="multiple-intents-for-the-same-action">
<h2>Multiple Intents for the same action<a class="headerlink" href="#multiple-intents-for-the-same-action" title="Permalink to this headline">¶</a></h2>
<p>Rain aims to allow replacement / extension of a specific feature. For instance, in the above example we imagined two providers for send mail action. The intent mechanism will decide which one to use (if the user already chose the default one he will not be prompted to choose between available implementations). Also, the security mechanism will be used for showing the possible candidates for a specified action.</p>
</div>
<div class="section" id="messaging-error-handling">
<h2>Messaging Error handling<a class="headerlink" href="#messaging-error-handling" title="Permalink to this headline">¶</a></h2>
<p>Rain must provide a pluggable mechanism for handling errors in case of server side messaging. Even if error handling is pluggable it must provide a default behavior.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Client Runtime: Messaging API (Proposal A)</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#functional-requirements">Functional requirements</a></li>
<li><a class="reference internal" href="#messaging-api">Messaging api</a></li>
<li><a class="reference internal" href="#client-side-messaging">Client side messaging</a><ul>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#server-side-messaging">Server side messaging</a><ul>
<li><a class="reference internal" href="#intent-lifecycle">Intent lifecycle</a></li>
<li><a class="reference internal" href="#id1">Intent lifecycle</a></li>
<li><a class="reference internal" href="#application-descriptor">Application descriptor</a></li>
<li><a class="reference internal" href="#client-side-view-controller-source-view">Client side view controller - source view</a></li>
<li><a class="reference internal" href="#client-side-view-controller-destination-view">Client side view controller - destination view</a></li>
</ul>
</li>
<li><a class="reference internal" href="#multiple-intents-for-the-same-action">Multiple Intents for the same action</a></li>
<li><a class="reference internal" href="#messaging-error-handling">Messaging Error handling</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="Features-proposal-client-language-inline-editing.html"
                        title="previous chapter">Client Language Inline Editing</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Features-proposal-client-runtime-a.html"
                        title="next chapter">Client Runtime (Proposal A)</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="Features-proposal-client-runtime-a.html" title="Client Runtime (Proposal A)"
             >next</a> |</li>
        <li class="right" >
          <a href="Features-proposal-client-language-inline-editing.html" title="Client Language Inline Editing"
             >previous</a> |</li>
        <li><a href="../index.html">Rain v0.29.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>